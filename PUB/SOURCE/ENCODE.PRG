FUNCTION ENCODE
PARAMETER STR
DIMENSION ASTR( 13)
EN1 = 'ABCDEFGHIJ'
EN2 = 'ACEGIKMBDL'
EN3 = 'CIBHAGMFLO'
EN4 = 'ECAKIGDBMJ'
EN5 = 'ELCFAHKJIB'
EN6 = 'DBGMIJKHAE'
EN7 = 'LFHJMBDGIA'
EN8 = 'JDKELFMGAC'
EN9 = 'LJHFDBMKIG'
EN10 = 'MLKJIHGFEA'
AA = SPACE(13)
GR = SPACE(10)
IF LEN(ALLTRIM(STR))=13
FOR I = 1 TO 13
STORE SUBSTR(STR, I, 1) TO ASTR( I)
ENDFOR
I1 = VAL(ASTR(1))
I13 = VAL(ASTR(13))
S1 = I1+1
S13 = I13+1
CO = ('en'+ALLTRIM(STR(S13)))
gr=&co 
ASTR( 1) = ALLTRIM(STR(S1))
ASTR( 13) = ALLTRIM(STR(S13))
FOR I = 2 TO 12
J = VAL(SUBSTR(STR, I, 1))
IF J=0
ASTR( I) = SUBSTR(GR, 10, 1)
ELSE
ASTR( I) = SUBSTR(GR, J, 1)
ENDIF
ENDFOR
K = INT(11/S13)
ASTR( 2) = CHR(ASC(ASTR(2))+S1)
FOR I = 1 TO K
ASTR( 2+(S13*I)) = CHR(ASC(ASTR(2+(S13*I)))+S1)
ENDFOR
ASTR( 1) = CHR(ASC('Z')-I1)
ASTR( 13) = CHR(ASC('Z')-I13)
AA = ''
FOR I = 1 TO 13
AA = AA+ASTR(I)
ENDFOR
ENDIF
RETURN AA

FUNCTION DECODE
PARAMETER STR
DIMENSION ASTR( 13)
EN1 = 'ABCDEFGHIJ'
EN2 = 'ACEGIKMBDL'
EN3 = 'CIBHAGMFLO'
EN4 = 'ECAKIGDBMJ'
EN5 = 'ELCFAHKJIB'
EN6 = 'DBGMIJKHAE'
EN7 = 'LFHJMBDGIA'
EN8 = 'JDKELFMGAC'
EN9 = 'LJHFDBMKIG'
EN10 = 'MLKJIHGFEA'
AA = SPACE(13)
GR = SPACE(10)
IF LEN(ALLTRIM(STR))=13
FOR I = 1 TO 13
STORE SUBSTR(STR, I, 1) TO ASTR( I)
ENDFOR
I1 = ASC('Z')-ASC(ASTR(1))
I13 = ASC('Z')-ASC(ASTR(13))
S1 = I1+1
S13 = I13+1
CO = ('en'+ALLTRIM(STR(S13)))
gr=&co 
K = INT(11/S13)
ASTR( 2) = CHR(ASC(ASTR(2))-S1)
FOR I = 1 TO K
ASTR( 2+(S13*I)) = CHR(ASC(ASTR(2+(S13*I)))-S1)
ENDFOR
ASTR( 1) = ALLTRIM(STR(I1))
ASTR( 13) = ALLTRIM(STR(I13))
FOR I = 2 TO 12
J = AT(ASTR(I), GR)
IF J=10
ASTR( I) = '0'
ELSE
ASTR( I) = ALLTRIM(STR(J))
ENDIF
ENDFOR
AA = ''
FOR I = 1 TO 13
AA = AA+ASTR(I)
ENDFOR
ENDIF
RETURN AA
