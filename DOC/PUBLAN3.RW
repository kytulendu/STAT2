.MT 2
.pn 38
.HE                                                              หน้า ##  
          4. เลือกรายการ การยืม/คืนแฟ้ม  จากรายการหลัก

                โปรแกรมสำหรับงานห้องบัตรและเวชระเบียน                     
                       STAT  Version 2.81                              
                        กระทรวงสาธารณสุข                               
                         8 คุลาคม 2536                                 
                                                                      
   ----------------------------------------------------------------   
     ลงทะเบียน    พิมพ์บัตร    เบิกแฟ้ม     ยืม/คืนแฟ้ม  บำรุงรักษา   เลิกงาน     
                                      ยืมและรับคืนแฟ้มผู้ป่วย                

       การยืม/คืนแฟ้ม  หมายถึง รายการที่จะแสดงการยืม/คืมแฟ้มผู้ป่วย จอภาพที่ 1 จอภาพ
รายการหลัก ถ้าเลือก "การยืม/คืมแฟ้มผู้ป่วยนอก" หน้าจอภาพจะปรากฏข้อความ ดังนี้      
          
              ยืม/คืนแฟ้มผู้ป่วยนอก    
          -----------------------
                  ยืมแฟ้ม          
                  คืนแฟ้ม          
                  แฟ้มค้างส่ง       
                  เลิกงาน         
          
     4.1 รายการ "ยืมแฟ้ม" จอภาพจะปรากฏข้อความให้บันทึกเลขที่ HN ที่ต้องการยืม ดังนี้  
         
              HN...........  ชื่อ.....................      
         
หาก HN นี้มีผู้ยืมไป จอภาพจะแสดง "ไม่มี HN นี้ กดปุ่มใดๆ เพื่อใส่ HN ใหม่" ก็บันทึก HN ที่ต้องการ
เช่น ต้องการยืมแฟ้มผู้ป่วยที่ HN = 3 ก็บันทึก 3 จอภาพจะปรากฏมีรายละเอียดดังนี้
      
         HN.         3         ชื่อ แดง มาแล้ว,นาย       
         วันที่ยืม 29/12/2536                             
         ผู้ยืม   ______                                 
      
วันที่ยืมแฟ้มโปรแกรมจะใช้วันที่ของเครื่องคอมพิวเตอร์เลยโดยไม่ต้องบันทึก บันทึกเฉพาะรหัสของผู้ยืมแฟ้ม 
หมายเหตุ  ผู้ยืมแฟ้มผู้ป่วยจะต้องเป็น 1. แพทย์ ใช้รหัสตามใบประกอบโรคศิลป
                            2. บุคลากรอื่นๆ โดยใช้รหัสหน่วยงานนั้นๆ เช่น รหัสคลินิค หรือ 
                               หอผู้ป่วย 
     
          HN.         3         ชื่อ แดง มาแล้ว,นาย      
          วันที่ยืม 29/12/2536                            
          ผู้ยืม    7914                                 
        -------------------------------------------   
       บันทึกแล้วไปรายต่อไป    บันทึกแล้วกลับรายการหลัก  แก้ไข  
     
ด้านล่างสุดของจอภาพ จะมีรายการให้เลือก 3 รายการ คือ 

     เลือก บันทึกแล้วไปรายการต่อไป หมายถึง จะให้บันทึก HN รายต่อไปที่ต้องการยืมแฟ้ม
     เลือก บันทึกแล้วกลับรายการหลัก หมายถึง กลับไปที่รายการหลัก                              
     เลือก แก้ไข หมายถึง การแก้ไขข้อมูล HN ที่บันทึกผิด    

     หมายเหตุ  โปรแกรม Stat v.2.81 จะเป็นระบบการทำงานในระบบ LAN ดังนั้นใน 
WORKSTATION แต่ละตัวจะถูกกำหนดให้รับข้อมูลในแต่ละส่วน เช่น ห้องบัตร ห้องตรวจผู้ป่วยนอก ฯลฯ เมื่อ
บันทึกข้อมูลของ ผู้ป่วยที่จะมารับบริการที่ห้องบัตรแล้ว โปรแกรมนี้ จะกำหนดให้ OPD Card ของผู้ป่วยรายนี้
ถูกยืมเป็นในห้องตรวจผู้ป่วยในแผนกนั้นๆ ทันที เราสามารถให้ OPD Card ถูกส่งคืนห้องบัตรได้ 2 วิธี 
     1. เจ้าหน้าที่ห้องเมื่อได้รับ OPD Card คืนเข้าไปในรายการคืนบัตรในรายการบำรุงรักษาระบบ
     2. ห้องตรวจผู้ป่วยบันทึกข้อมูลการวินิจฉัยโรคเรียบร้อยแล้ว โดยเจ้าหน้าที่ห้องบัตรไม่ต้องเข้ารายการ
ส่งคืน โดย set ใน File AUTOEXEC.BAT ดังนี้ SET WOKSTATION=STAT สำหรับเครื่องที่ห้องตรวจด้วย
     สำหรับโรงพยาบาลที่ใช้โปรแกรมนี้บนเครื่องไมรคอมพิวเตอร์ ต้อง set ใน File AUTOEXEC.BAT
SET WORKSTATION = STAT เมื่อบันทึกข้อมูลผู้ป่วยในส่วนของห้องตรวจเรียบร้อย โปรแกรมจะดำเนินการส่ง
คืน OPD Card ของผู้ป่วยให้ทันที                                                     
.pa
     4.2 เลือก รายการ"คืนแฟ้ม" จอภาพจะปรากฏข้อความให้บันทึก HN ที่ต้องการคืน 
         
              HN...........  ชื่อ.....................      
         
Cursor รออยู่ที่ HN บันทึกเลขที่ HN สมมุติว่าต้องการส่งคืนแฟ้มผู้ป่วยเลขที่ HN = 3 กดปุ่มเลข 3
จอภาพจะปรากฏรายละเอียดต่างๆ ดังนี้
     
           HN.         3        ชื่อ แดง มาแล้ว,นาย     
           วันที่ยืม 29 ธ.ค. 2536                        
           ผู้ยืม      7914                             
           วันที่คืน 29 ธ.ค. 2536                        
        -------------------------------------------- 
                                                     
        บันทึกแล้วไปรายต่อไป  บันทึกแล้วกลับรายการหลัก  แก้ไข  
     
      บันทึกแล้วไปรายการต่อไป จะให้บันทึก HN รายต่อไปที่ต้องการคืนแฟ้ม 
      บันทึกแล้วกลับรายการหลัก   
      แก้ไข หมายถึงการแก้ไข HN ที่บันทึกผิด จอภาพจะปรากฏข้อความ   

     4.3 เลือก รายการ "แฟ้มที่ค้างส่ง" เป็นการแสดงรายการผู้ยืมและแฟ้มที่ยังไม่ได้ส่งคืน ดังนี้
     
        
            วันที่ยืมแฟ้ม             29/12/2536        
        
      --------------------------------------------   
             ใส่วัน เดือน ปี เป็นปีพุทธศักราช                
     
จอภาพจะแสดงข้อความเพื่อให้บันทึก วันที่ยืมแฟ้ม (โดยจะแสดงวันที่ปัจจุบันให้)
.pa
     
        
            วันที่ยืมแฟ้ม             29/12/2536        
        
      --------------------------------------------   
             ใส่วัน เดือน ปี เป็นปีพุทธศักราช                
                                                     
          แสดงข้อมูลทางจอภาพ       พิมพ์ข้อมูลลงกระดาษ     
     
โปรแกรมจะเลือกการแสดงข้อมูลทางจอภาพ หรือพิมพ์ลงกระดาษ โดยการเลื่อนแถบแสดง กดปุ่ม 
<Enter> หากเลือกให้แสดงทางจอภาพจะปรากฏข้อความ ดังนี้
     
         HN              ชื่อ            วันที่ยืม         เวลายืม   
        ผู้ยืม                                                   
        1234                                                  
        00004-36    สมนึก นาดี;นาย      10/09/2536     09.31    
                                                              
            DONE   MORE                                       
     
จะแสดงข้อมูลในดูที่จะจอภาพหากต้องการดูในหน้าต่อไป กดแป้น <Tab> ไป MORE กด <Enter> ก็จะ
สามารถดูข้อมูลในหน้าถัดไป หากต้องการออกจากจอหน้านั้ กดแป้น Tab มาที่ DONE ก็จะกลับมาที่เมนู
รายการยืม/คืนแฟ้ม กดปุ่ม <Esc> จะกลับสู่รายการหลัก
.pa
                       การแก้ไขข้อมูลที่ผิดพลาด
     หากเกิดการผิดพลาดข้อมูลผู้ป่วยไม่ว่าจะเป็นส่วนใดของข้อมูลก็ตาม เช่น ชื่อ-นามสกุล ผิดหรือ
ต้องการเปลี่ยนแปลง ที่อยู่ หรือ คำนำหน้าชื่อ เราก็มีวิธีการที่จะแก้ไขข้อมูลที่ผิด หรือต้องการเปลี่ยน
แปลงได้ ตามลำดับดังนี้
   1.ในจอภาพลงทะเบียนผู้ป่วย กดแป้น Shift+F2 (กดแป้น Shift และ F2 พร้อมกัน) ใส่เลขที่
ผู้ป่วย(H.N.)ที่ต้องการจะแก้ไข จอภาพจะแสดงข้อมูลผู้ป่วย ซึ่งจะเป็นจอภาพเดียวกับจอภาพลงทะเบียน
ผู้ป่วย (ถ้าช่องตรวจที่คลีนิครหัส ZZZ ห้องเก็บเวชระเบียน เพราะแฟ้มผู้ป่วยได้ถูกส่งคืนมาแล้ว)
    
      เวลา 10.00 น.        โรงพยาบาลพระนั่งเกล้า                          
      วัน เดือน ปี                  ลงทะเบียนผู้ป่วย                          
     ------------------------------------------------------------------
     ชื่อผู้ป่วย    อิงอร ไทยเดิม,นาง                    เลขที่ผู้ป่วยนอก 0000009  
     เพศ 2 หญิง            ที่อยู่  03 หองใหญ่                              1
     จังหวัด 20 ชลบุรี               อำเภอ  03 หนองใหญ่                     
     ตำบล  05 เขาซก                หมู่ที่  01                            2
     โทรศัพท์                                                            
     วันเกิด 21 ส.ค. 2499     อายุ     37 ปี         เชื่อเถือได้  1 ได้       3
     สภาพสมรส  2         อาชีพ   110 อาจารย์มหาวิทยาลัย                    
     เชื้อชาติ  99 ไทย                                                   4
     สัญชาติ   99  ไทย                                                   
     ชื่อแม่   นางผาแต้ม ไทยเดิม                                           5
     ชื่อพ่อ                                                              
     ชื่อผู้ติดต่อได้  นางผาแต้ม ไทยเดิม                                       6
     ที่อยู่       บ.ด.ก.                                                  
     จังหวัด                           อำเภอ                            7
     ตำบล                            หมู่ที่                               
     สิทธิการรักษา  20 ใช้สิทธิเบิกหน่วยงานต้นสังกัด                             8
     ตรวจที่คลินิก   011 อายุกรรมหญิง                                        
     ----------------------------------------------------------------- 
                [ESC] = สิ้นสุดการใส่ข้อมูล     [<F1>] = ขอความช่วยเหลือ       
        
Cursor จะอยู่ที่ช่องชื่อผู้ป่วย เพื่อรอการแก้ไขหากไม่ต้องการแก้ไขในช่องใด กดปุ่ม [Enter] 
   2.แก้ไขข้อมูลที่ต้องการ โดยใช้หลักการเดียวกันกับจอภาพลงทะเบียนผู้ป่วย
   3.เมื่อแก้ไขข้อมูลตรงตำแหน่งที่ผิดพลาดเรียบร้อยแล้ว ให้กดแป้น <Esc> จะมีแถบแสงขึ้นอยู่ตอนที่ 3  
เลือกรายการต่าง ๆ ที่ต้องการ ตามที่ได้กล่าวไว้แล้วในจอภาพลงทะเบียนผู้ป่วย 
    
      เวลา 10.00 น.        โรงพยาบาลพระนั่งเกล้า                          
      วัน เดือน ปี                  ลงทะเบียนผู้ป่วย                          
     ------------------------------------------------------------------
     ชื่อผู้ป่วย นางอิงอร ไทยเดิม                        เลขที่ผู้ป่วยนอก 0000009  
     เพศ 2 หญิง            ที่อยู่  03 หองใหญ่                              1
     จังหวัด 20 ชลบุรี               อำเภอ  03 หนองใหญ่                     
     ตำบล  05 เขาซก                หมู่ที่  01                            2
     โทรศัพท์                                                            
     วันเกิด 21 ส.ค. 2499     อายุ     37 ปี         เชื่อเถือได้  1 ได้       3
     สภาพสมรส  2         อาชีพ   110 อาจารย์มหาวิทยาลัย                    
     เชื้อชาติ  99 ไทย                                                   4
     สัญชาติ   99  ไทย                                                   
     ชื่อแม่   นางผาแต้ม ไทยเดิม                                           5
     ชื่อพ่อ                                                              
     ชื่อผู้ติดต่อได้  นางผาแต้ม ไทยเดิม                                       6
     ที่อยู่       บ.ด.ก.                                                  
     จังหวัด                           อำเภอ                            7
     ตำบล                            หมู่ที่                               
     สิทธิการรักษา  20 ใช้สิทธิเบิกหน่วยงานต้นสังกัด                             8
     ตรวจที่คลินิก   011 อายุกรรมหญิง                                        
    
          A = บันทึกข้อมูล  C = ยกเลิกข้อมูล  E = แก้ไขข้อมูล  P = บันทึกและพิมพ์บัตร 
    
          ความหมาย ของแต่ละรายการ  
"A = บันทึกข้อมูล"      หมายความว่า เก็บบันทึกข้อมูลต่างๆ ที่บันทึกไว้ในตอนต้นลงในระบบความจำ
                               ของคอมพิวเตอร์ 
"C = ยกเลิกข้อมูล"     หมายความว่า ข้อมูลต่าง ๆ ที่บันทึกไว้ข้างต้นจะถูกลบออกทั้งหมด
"E = แก้ไขข้อมูล"      หมายความว่า กลับไปแก้ไขข้อมูลต่าง ๆ ที่บันทึกไว้ข้างต้นให้ถูกต้อง
"P = บันทึกและพิมพ์บัตร" หมายความว่า ข้อมูลต่าง ๆ ที่บันทึกไว้ข้างต้นจะถูกเก็บบันทึกลงในระบบความจำ
                               ของคอมพิวเตอร์และพิมพ์บัตรผู้มารับบริการออกทาง Printer  
                      การลงทะเบียนผู้ป่วยนอกเก่า
     การลงทะเบียนผู้ป่วยเก่า หมายถึง การบันทึกข้อมูลของผู้ป่วยที่เคยมารับบริการจากโรงพยาบาล
แล้ว มีวิธีการดังนี้ จากหน้าจอการลงทะเบียน  Cursor จะอยู่ที่ช่องชื่อผู้ป่วย  บันทึกเลขที่ทั่วไป (HN)   
ลงในช่องชื่อผู้ป่วยกด <Enter> ข้อมูลผู้ป่วยนอกเก่าก็จะปรากฏออกมาทางจอภาพ 
    
      เวลา 10.00 น.        โรงพยาบาลพระนั่งเกล้า                          
      วัน เดือน ปี                  ลงทะเบียนผู้ป่วย                          
     ------------------------------------------------------------------
     ชื่อผู้ป่วย นางอิงอร ไทยเดิม                        เลขที่ผู้ป่วยนอก 0000009  
     เพศ 2 หญิง            ที่อยู่  03 หองใหญ่                              1
     จังหวัด 20 ชลบุรี               อำเภอ  03 หนองใหญ่                     
     ตำบล  05 เขาซก                หมู่ที่  01                            2
     โทรศัพท์                                                            
     วันเกิด 21 ส.ค. 2499     อายุ     37 ปี         เชื่อเถือได้  1 ได้       3
     สภาพสมรส  2         อาชีพ   110 อาจารย์มหาวิทยาลัย                    
     เชื้อชาติ  99 ไทย                                                   4
     สัญชาติ   99  ไทย                                                   
     ชื่อแม่   นางผาแต้ม ไทยเดิม                                           5
     ชื่อพ่อ                                                              
     ชื่อผู้ติดต่อได้  นางผาแต้ม ไทยเดิม                                       6
     ที่อยู่       บ.ด.ก.                                                  
     จังหวัด                           อำเภอ                            7
     ตำบล                            หมู่ที่                               
     สิทธิการรักษา  20 ใช้สิทธิเบิกหน่วยงานต้นสังกัด                             8
     ตรวจที่คลินิก   011 อายุกรรมหญิง                                        
     ----------------------------------------------------------------- 
                [ESC] = สิ้นสุดการใส่ข้อมูล     [<F1>] = ขอความช่วยเหลือ       
    
Cursor จะกระพริบอยู่ที่บรรทัดที่ 16 สิทธิการรักษา ถ้ามีการเปลี่ยนแปลงสิทธิการรักษาก็สามารถแก้ไขได้
แล้วกดแป้น <Enter> Cursor จะกระพริบอยู่ที่บรรทัดที่ 17 ตรวจที่คลินิก ถ้าเป็น รหัส ZZZ ห้องเก็บงาน
เวชระเบียน แสดงว่าแฟ้มของผู้ป่วยได้ถูกส่งมาเก็บไว้ที่ห้องเวชระเบียนแล้ว ให้เลือกคลินิกที่ผู้ป่วยต้องการจะ
ตรวจเมื่อเรียบร้อยแล้วจะมีรายการ (menu) ขึ้นมาด้านล่างสุดของจอภาพดังนี้ 

    
      เวลา 10.00 น.        โรงพยาบาลพระนั่งเกล้า                          
      วัน เดือน ปี                  ลงทะเบียนผู้ป่วย                          
     ------------------------------------------------------------------
     ชื่อผู้ป่วย นางอิงอร ไทยเดิม                        เลขที่ผู้ป่วยนอก 0000009  
     เพศ 2 หญิง            ที่อยู่  03 หองใหญ่                              1
     จังหวัด 20 ชลบุรี               อำเภอ  03 หนองใหญ่                     
     ตำบล  05 เขาซก                หมู่ที่  01                            2
     โทรศัพท์                                                            
     วันเกิด 21 ส.ค. 2499     อายุ     37 ปี         เชื่อเถือได้  1 ได้       3
     สภาพสมรส  2         อาชีพ   110 อาจารย์มหาวิทยาลัย                    
     เชื้อชาติ  99 ไทย                                                   4
     สัญชาติ   99  ไทย                                                   
     ชื่อแม่   นางผาแต้ม ไทยเดิม                                           5
     ชื่อพ่อ                                                              
     ชื่อผู้ติดต่อได้  นางผาแต้ม ไทยเดิม                                       6
     ที่อยู่       บ.ด.ก.                                                  
     จังหวัด                           อำเภอ                            7
     ตำบล                            หมู่ที่                               
     สิทธิการรักษา  20 ใช้สิทธิเบิกหน่วยงานต้นสังกัด                             8
     ตรวจที่คลินิก   011 อายุกรรมหญิง                                        
                                                                       
    
          A = บันทึกข้อมูล  C = ยกเลิกข้อมูล  E = แก้ไขข้อมูล  P = บันทึกและพิมพ์บัตร 
    
          ความหมาย ของแต่ละรายการ  
"A = บันทึกข้อมูล"      หมายความว่า เก็บบันทึกข้อมูลต่างๆ ที่บันทึกไว้ในตอนต้นลงในระบบความจำ
                               ของคอมพิวเตอร์ เป็นผู้ป่วยเก่าที่มารับบริการครั้งต่อมา
"C = ยกเลิกข้อมูล"     หมายความว่า ข้อมูลต่าง ๆ ที่บันทึกไว้ข้างต้นจะถูกลบออกทั้งหมด
"E = แก้ไขข้อมูล"      หมายความว่า กลับไปแก้ไขข้อมูลต่าง ๆ ที่บันทึกไว้ข้างต้นให้ถูกต้อง
"P = บันทึกและพิมพ์บัตร" หมายความว่า ข้อมูลต่าง ๆ ที่บันทึกไว้ข้างต้นจะถูกเก็บบันทึกลงในระบบความจำ
                               ของคอมพิวเตอร์และพิมพ์บัตรผู้มารับบริการออกทาง Printer  

   
            การใช้หาดัชนีชื่อ (Name Index)
     โปรแกรม STAT Version 2.81 นี้สามารถหา HN ของผู้ป่วยจากชื่อแทนการหาดัชนีได้ ในกรณีที่
ผู้ป่วยลืมบัตรประจำตัวของผู้ป่วยทำให้ลดเวลาในการหาดัชนีชื่อได้สามารถประหยัดกำลังคน ในการทำบัตร
ดัชนี และค้นหา

     การใช้โปรแกรม STAT Version 2.81 เป็นดัชนีชื่อ มีขั้นตอนดังนี้
     1.พิมพ์ชื่อ หรือชื่อและนามสกุล ของผู้มารับบริการ(โดยไม่ต้องใส่คำนำหน้าชื่อ เช่น นาย,นาง,
พภ.ฯลฯ)หรือ อาจจะพิมพ์เฉพาะชื่ออย่างเดียวก็ได้แล้วกด <Enter> จอภาพจะขึ้นรายชื่อผู้มารับบริการ
มาให้เลือก หรืออาจค้นหาด้วยนามสกุลของผู้ป่วย โดยในช่องชื่อผู้ป่วยให้ เว้นช่องว่าง 1 เคาะแล้วพิมพ์
นามสกุล กด <Enter> หน้าจอจะปรากฏรายชื่อผู้ป่วยทั้งหมด
     2.เมื่อรายชื่อทั้งหมดขึ้นมาวิธีการเลือกรายชื่อที่ต้องการทำได้โดยกดแป้นตัวอักษรที่นำหน้าชื่อที่
ต้องการ เช่น 
       
          ชื่อ                         ชื่อแม่      เลขที่ทั่วไป       วันเกิด     
         A อิงอร ไทยเดิม,นาง                      0000001                 
         B วิโรจน์ เพ่งผล,นพ.                      0000002                 
         C สุมาลี พงษ์ทอง,นาง                      0000003                 
         D พิภพ โค้วถาวร,นาย                      0000004                 
          
     ถ้าชื่อที่เราต้องการคือ อิงอร ไทยเดิม,นาง ให้กดแป้นตัวอักษร A จอภาพจะกลับเข้าสู่จอภาพลง
ทะเบียนผู้ป่วยพร้อมรายละเอียดข้อมูลของ นางอิงอร ไทยเดิม ดังนี้
.pa
    
      เวลา 10.00 น.        โรงพยาบาลพระนั่งเกล้า                          
      วัน เดือน ปี                  ลงทะเบียนผู้ป่วย                          
     ------------------------------------------------------------------
     ชื่อผู้ป่วย นางอิงอร ไทยเดิม                        เลขที่ผู้ป่วยนอก 0000009  
     เพศ 2 หญิง            ที่อยู่  03 หองใหญ่                              1
     จังหวัด 20 ชลบุรี               อำเภอ  03 หนองใหญ่                     
     ตำบล  05 เขาซก                หมู่ที่  01                            2
     โทรศัพท์                                                            
     วันเกิด 21 ส.ค. 2499     อายุ     37 ปี         เชื่อเถือได้  1 ได้       3
     สภาพสมรส  2         อาชีพ   110 อาจารย์มหาวิทยาลัย                    
     เชื้อชาติ  99 ไทย                                                   4
     สัญชาติ   99  ไทย                                                   
     ชื่อแม่   นางผาแต้ม ไทยเดิม                                           5
     ชื่อพ่อ                                                              
     ชื่อผู้ติดต่อได้  นางผาแต้ม ไทยเดิม                                       6
     ที่อยู่       บ.ด.ก.                                                  
     จังหวัด                           อำเภอ                            7
     ตำบล                            หมู่ที่                               
     สิทธิการรักษา  20 ใช้สิทธิเบิกหน่วยงานต้นสังกัด                             8
     ตรวจที่คลินิก   011 อายุกรรมหญิง                                        
                                                                       
     ----------------------------------------------------------------- 
                [ESC] = สิ้นสุดการใส่ข้อมูล     [<F1>] = ขอความช่วยเหลือ       
    
โดย Cursor จะกระพริบอยู่ที่บรรทัดที่ 16 สิทธิการรักษา ถ้ามีการเปลี่ยนแปลงสิทธิการรักษาก็สามารถ
แก้ไขได้  แล้วกดแป้น <Enter> Cursor จะกระพริบอยู่ที่บรรทัดที่ 17 ตรวจที่คลินิก ให้เลือกคลินิกที่
ผู้ป่วยต้องการจะตรวจ เมื่อเรียบร้อยแล้วจะมีรายการ (menu) ขึ้นมาด้านล่างสุดของจอภาพดังนี้
.pa
    
      เวลา 10.00 น.        โรงพยาบาลพระนั่งเกล้า                          
      วัน เดือน ปี                  ลงทะเบียนผู้ป่วย                          
     ------------------------------------------------------------------
     ชื่อผู้ป่วย นางอิงอร ไทยเดิม                        เลขที่ผู้ป่วยนอก 0000009  
     เพศ 2 หญิง            ที่อยู่  03 หองใหญ่                              1
     จังหวัด 20 ชลบุรี               อำเภอ  03 หนองใหญ่                     
     ตำบล  05 เขาซก                หมู่ที่  01                            2
     โทรศัพท์                                                            
     วันเกิด 21 ส.ค. 2499     อายุ     37 ปี         เชื่อเถือได้  1 ได้       3
     สภาพสมรส  2         อาชีพ   110 อาจารย์มหาวิทยาลัย                    
     เชื้อชาติ  99 ไทย                                                   4
     สัญชาติ   99  ไทย                                                   
     ชื่อแม่   นางผาแต้ม ไทยเดิม                                           5
     ชื่อพ่อ                                                              
     ชื่อผู้ติดต่อได้  นางผาแต้ม ไทยเดิม                                       6
     ที่อยู่       บ.ด.ก.                                                  
     จังหวัด                           อำเภอ                            7
     ตำบล                            หมู่ที่                               
     สิทธิการรักษา  20 ใช้สิทธิเบิกหน่วยงานต้นสังกัด                             8
     ตรวจที่คลินิก   011 อายุกรรมหญิง                                        
    
          A = บันทึกข้อมูล  C = ยกเลิกข้อมูล  E = แก้ไขข้อมูล  P = บันทึกและพิมพ์บัตร 
    
          ความหมาย ของแต่ละรายการ  
"A = บันทึกข้อมูล"      หมายความว่า เก็บบันทึกข้อมูลต่างๆ ที่บันทึกไว้ในตอนต้นลงในระบบความจำ
                               ของคอมพิวเตอร์ เป็นผู้ป่วยเก่าที่มารับบริการครั้งต่อมา
"C = ยกเลิกข้อมูล"     หมายความว่า ข้อมูลต่าง ๆ ที่บันทึกไว้ข้างต้นจะถูกลบออกทั้งหมด
"E = แก้ไขข้อมูล"      หมายความว่า กลับไปแก้ไขข้อมูลต่าง ๆ ที่บันทึกไว้ข้างต้นให้ถูกต้อง
"P = บันทึกและพิมพ์บัตร" หมายความว่า ข้อมูลต่าง ๆ ที่บันทึกไว้ข้างต้นจะถูกเก็บบันทึกลงในระบบความจำ
                               ของคอมพิวเตอร์และพิมพ์บัตรผู้มารับบริการออกทาง Printer  


                           การเข้าสู่หน้าจอการทำรายงาน 
     เราสามารถจัดทำรายงาน ซึ่งการจัดทำรายงานต่างๆ นี้จะใช้ข้อมูลจากการลงทะเบียนจากห้องบัตร 
ซึ่งอาจไม่ตรงกับการคำนวณจากในรายการของห้องตรวจผู้ป่วยนอก (OPD) เพราะผู้ป่วยหรือผู้มารับบริการ
อาจยกเลิกการตรวจ หรือกลับบ้านการได้รับการรักษา หรือเปลี่ยนคลีนิคที่ตรวจ  เมื่อเข้าในรายการนี้ 
จอภาพจะปรากฏข้อความ ดังนี้
         
                      แก้ไขค่าต่าง ๆ                  
            1. บัตรดัชนี                               
            2. ค้นหาตามเงื่อนไข                        
            3. ค้นหา HN และชื่อตามเงื่อนไข             
            4. ค้นหาคนไข้ใหม่ในปีตามเงื่อนไข           
            5. ค้นหา HN และชื่อคนไข้ใหม่ในปีตามเงื่อนไข  
            6. หาจำนวนคนไข้รับไว้ในโรงพยาบาล        
            0. กลับรายการเดิม                          
          
     เลือก 1. บัตรดัชนี เป็นการจัดทำบัตรดัชนีของผู้ป่วย ทางโรงพยาบาลจะสามารถค้นบัตรผู้ป่วยได้ง่าย
ในกรณีที่ไฟฟ้าดับ หรือเครื่องคอมพิวเตอร์ไมาสามารถทำงานได้ จอภาพจะปรากฏข้อความ ดังนี้
         
              พิมพ์บัตรดัชนีตั้งแต่เลขที่         0       
                                                
                         ถึงเลขที่         0       
         
เราสามารถพิมพ์เฉพาะเลขที่ผู้ป่วยที่เราต้องการได้ โดยการบันทึกช่วงเลขที่ผู้ป่วยนอก (HN) ที่ต้องการ
แล้วกดแป้น <Enter> จอภาพจะปรากฏข้อความในเลือกชนิดของกระดาษ ด้งนี้
         
                   1. พิมพ์กระดาษทีละแผ่น           
                   2. พิมพ์กระดาษต่อเนื่อง           
                                           
หากเครื่องพิมพ์ยังไม่พร้อม จะปรากฏว่าข้อความเตือน ดังนี้
     
         เครื่องพิมพ์ยังไม่พร้อม โปรดแก้ไข หรือกดปุ่ม [ESC] ยกเลิกการพิมพ์      
     
   
     เลือก 2 ค้นหาตามเงื่อนไข เป็นโปรแกรมการจัดทำรายงานเป็นตาราง 2 มิติ ตามเงื่อนไขที่กำหนด
 เมื่อเลือกรายการนี้ จอภาพจะปรากฏข้อความดังนี้
          
     ส่วนที่1    คำสั่ง    
                  
                  
     ส่วนที่2                                                   
                  
          
     ส่วนที่1 เป็นส่วนที่จะให้เลือกตัวแปรในการนำไปคำนวณ  จอภาพจะปรากฏข้อความดังนี้
          
                   เพศ                     
                   อาชีพ                    
                   สภาพสมรส                
                   สัญชาติ                   
                   ที่อยู่  ในเขต-นอกเขต       
                   ที่อยู่ตามจังหวัด             
                      ฯลฯ                  
          

     วิธีการเลือกตัวแปรดังนี้
     1. ใช้แป้นลูกศรขึ้น ลง เมื่อตรงกับตัวแปรที่ต้องการกดแป้น <Enter> 
     2. กดแป้นอักษรตัวแรกของตัวแปรที่ต้องการแล้วกดแป้น <Enter) 
      เช่น  ต้องการทราบว่ามีผู้ป่วยมารับบริการทั้งหมดเป็นเพศและมีสภาพสมรสเท่าไร (ตัวแปรแรกจะ
เป็นแกน Y อยู่ในแนวตั้ง ต้องเลือกตัวแปรที่มีรายละเอียดมาก ตัวแปรที่ 2 เป็นแกน X อยู่ในแนวนอนของ
ตาราง)  มีวิธีดังนี้

     เมื่อเข้ารายการนี้จะมีรายการชื่อตัวแปร(ตามตารางข้างบน)ให้เลือก เลื่อน แถบแสงไปที่สภาพสมรส
หรือ กดอักษร ส กดแป้น <Enter> จะมีรายการชื่อตัวแปรให้เลือก การเลือกตัวแปร 2 ตัว ใช้วิธีการเช่น
เดียวกันตัวแปรตัวแรก เลื่อนแถบแสงไปที่ เพศ หรือ กดแป้น เ กด <Enter> จอภาพจะปรากฏข้อความดังนี้



          
              คำสั่ง    
              ตารางเปรียบเทียบระหว่างสภาพสมรส กับ เพศ            
                  
                  
   ส่วนที่ 2                                                    
                  
          
     Cursor จะไปอยู่ที่ส่วนที่ 2 ถ้าไม่มีเงื่อนไขให้กด <Enter> จอภาพจะปรากฏข้อความให้บันทึกช่วง
เวลาที่ต้องการข้อมูล 
     หากมีเงื่อนไข เพื่อให้ได้รายงานตามต้องการ กดแป้น F1 จอภาพจะปรากฏรายชื่อตัวแปร เพื่อเลือก
เงื่อนไขอื่นๆ 
     สมมุติ จากตัวอย่างข้างบน ต้องการทราบว่าผู้มารับบริการทั้งหมดเป็นมีสภาพสมรสและเพศเท่าไร และ
ต้องการเฉพาะคลีนิคอายุรกรรมและอยู่ภายในจังหวัด ให้เลื่อนแถบแสงไปที่คลีนิคที่ตรวจ หรือกดแป้น ค แล้ว
กดแป้น <Enter> มีรายการให้เลือกดังนี้
          
              คำสั่ง    
              ตารางเปรียบเทียบระหว่างเพศ กับ สภาพสมรส            
                  
              เงื่อนไข    
              คลีนิคที่ตรวจ                              
   ส่วนที่ 2                  เท่ากับ                           
              ไม่เท่ากับ    
          มากกว่า
                             น้อยกว่า
                             ระหว่าง

   การเลือกเงื่อนไขต่างๆ เช่น ต้องการทราบจำนวนผู้ป่วยว่าเป็นผู้ป่วยใหม่และผู้ป่วยเก่าเท่าไร 
เลือกประเภทการมามีรหัส 1=ผู้ป่วยใหม่ 2=ผู้ป่วยเก่า 3=ติดตามผล มีวิธีเลือกเงื่อนไขได้หลายวิธีคือ
1. เลือกเงื่อนไข ไม่เท่ากับ  ติดตามผล (รหัส =3)                                  
2. เลือกเงื่อนไข น้อยกว่า  ติดตามผล (รหัส = 3)                                  
3. เลือกเงื่อนไข ระหว่าง  ผู้ป่วยใหม่ ผู้ป่วยเก่า โดยบันทึกรหัส 1,2  จะได้ผลลัพธ์เหมือนกัน   

แถบแสงจะรออยู่ที่ "เท่ากับ" กดแป้น <Enter> จอภาพจะปรากฏข้อความ ดังนี้
            
              คำสั่ง      
              ตารางเปรียบเทียบระหว่างเพศ กับ สภาพสมรส              
                    
              เงื่อนไข      
               คลีนิคที่ตรวจ  เท่ากับ                    
                                            อายุรกรรม         
               ศัลยกรรม        
            
ถ้าเลือก อายุรกรรม กดแป้น <Enter> แล้วจะมีจอภาพให้เลือกเงื่อนไข "และ" "หรือ" "หมดเงื่อนไข"
ต้องพิจารณาเลือกให้เหมาะสมด้วย กรณีนี้ควรเลือก และ  กดแป้น <Enter> ดังนี้
          
              คำสั่ง    
              ตารางเปรียบเทียบระหว่างเพศ กับ สภาพสมรส            
                  
              เงื่อนไข    
               คลีนิคที่ตรวจ  เท่ากับ อายุรกรรม         
                                             และ           
                หรือ         
           หมดเงื่อนไข
                                                       
Cursor จะไปอยู่ที่บรรทัดที่ 2 กด F1 เลือกตัวแปรตามวิธีข้างต้นจะเป็น "อยู่ในเขต นอกเขต" "เท่ากับ"
"ในเขต" แล้วเลือก "หมดเงื่อนไข" หากมีเงื่อนไขอื่นอีกก็ปฏิบัติตามข้างต้นที่กล่าวมาแล้ว  
     เมื่อเลือกหมดเงื่อนไข แล้วจะจอภาพจะมีข้อความให้บันทึกระยะเวลาที่ต้องการ มีรายละเอียดดังนี้
.pa
      
            
             คำสั่ง       
             ตารางเปรียบเทียบระหว่างเพศ กับ สภาพสมรส               
                    
             เงื่อนไข       
             คลีนิคที่ตรวจ เท่ากับ อายุรกรรม และ                      
             อยู่ในเขต นอกเขต เท่ากับ ในเขต                        
                    
            
            
             ตั้งแต่วันที่ __/__/____       ถึงวันที่ __/__/____           
            
      
บันทึกระยะเวลาที่ต้องการทราบข้อมูลจากตัวแปรและเงื่อนไขต่างๆที่เลือกไว้ โดยจะแสดงผลลัพธ์ทางจอภาพ
   รายงานแบบตาราง
     หน้าที่ 1              ตารางเปรียบเทียบระหว่าง สภาพสมรส กับ เพศ      
                                 รพท.มหาสารคาม                   
                        ชาย        หญิง      รวม         %          
     โสด                  1          2         3     100.00        
     รวม                  1          2         3     100.00        
      %               33.33      66.67    100.00                   
     หมายเหตุ   คลีนิคเท่ากับอายุกรรม และอยู่ในเขต                         
               ตั้งแต่วันที่ 13 ส.ค. 2538 ถึงวันที่ 13 ส.ค. 2538             
     
     หากต้องการเก็บผลลัพธ์ไว้ก่อนหรือพิมพ์ลงบนกระดาษ เมื่อกดปุ่ม F1 จะมีเมนูย่อยอธิบายวิธี
          
            กดปุ่ม [P]  เพื่อพิมพ์รายงานลงกระดาษ      
            กดปุ่ม [C]  เพื่อเก็บรายงานลงแผ่น DISK    
            กดปุ่ม [Esc]เพื่อเลิกรายการนี้             
          
สามารถใช้ได้กับทุกรายงานในการจัดทำรายงานต่างๆจากรายการค้นหาตามเงื่อนไข

     เมื่อกดปุ่ม [P] จะมีเมนูให้เลือกว่าต้องการพิมพ์รายงานด้วยกระดาษชนิดไหน
          
              1. พิมพ์กระดาษที่ละแผ่น   
              2. พิมพ์กระดาษต่อเนื่อง   
          
หากเครื่องพิมพ์ยังไม่พร้อม จะมีข้อความเตือนที่มุมด้านบน "เครื่องพิมพ์ไม่พร้อม โปรดแก้ไข หรือ กดปุ่ม
[Esc] ยกเลิกจากพิมพ์"
     กดปุ่ม [C] จะมีข้อความให้บันทึกชื่อแฟ้มข้อมูล ดังนี้
          
              เก็บข้อมูลไว้ในแฟ้มชื่อ ___________              
          
บันทึกชื่อแฟ้มข้อมูลที่ต้องการเก็บข้อมูลรายงานนั้นไว้ โดยเก็บไว้ใน C:\OPD หรือถ้าต้องการเก็บข้อมูลไว้
ใส่แผ่น Disk พิมพ์ A: หรือB: แล้วตามด้วยชื่อแฟ้ม หากต้องการนำข้อมูลมาใช้ใช้คำสั่งType ตามด้วย
ชื่อแฟ้มข้อมูลที่ตั้งไว้ หรือใช้โปรแกรมในการพิมพ์ต่างๆ ได้                                     

     เลือก 3. ค้นหา HN และชื่อตามเงื่อนไข เป็นรายการค้นหาเลขที่ผู้ป่วยนอกและชื่อ ตามเงื่อนไขที่
เราสามารถกำหนดได้เองตามตัวแปรต่างๆ จอภาพจะปรากฏข้อความดังนี้
           เงื่อนไข
             1.                                        
             2.                                        
             3.                                        
             4.                                        
             5.                                        
             6.                                        
           
กดแป้น F1 จอภาพจะปรากฏรายชื่อตัวแปรให้เพื่อเลือกเงื่อนไขอื่นๆ จอภาพจะปรากฏรายการให้เลือกดังนี้
.pa
          
                   เพศ                     
                   อาชีพ                    
                   สภาพสมรส                
                   สัญชาติ                   
                   ที่อยู่  ในเขต-นอกเขต       
                   ที่อยู่ตามจังหวัด             
                      ฯลฯ                  
          
ใช้แป้นลูกศรขึ้น ลง หรืออักษรตัวแรกของตัวแปร ก็ได้ เมื่อตรงกับตัวแปรที่ต้องการ กดแป้น <Enter> เช่น
ต้องการทราบรายชื่อผู้ป่วยที่เข้ารับการักษาที่มี อาชีพ รับราชการ เลื่อนแถบแสงมาที่รายการอาชีพ กดแป้น <Enter> จอภาพจะปรากฏข้อความดังนี้
               เงื่อนไข     
               อาชีพ                                    
                            เท่ากับ                            
               ไม่เท่ากับ     
                             มากกว่า                            
                             น้อยกว่า
                             ระหว่าง

   การเลือกเงื่อนไขต่างๆ เช่น ต้องการทราบจำนวนผู้ป่วยว่าเป็นผู้ป่วยใหม่และผู้ป่วยเก่าเท่าไร 
เลือกประเภทการมามีรหัส 1=ผู้ป่วยใหม่ 2=ผู้ป่วยเก่า 3=ติดตามผล มีวิธีเลือกเงื่อนไขได้หลายวิธีคือ
1. เลือกเงื่อนไข ไม่เท่ากับ  ติดตามผล (รหัส =3)                                  
2. เลือกเงื่อนไข น้อยกว่า  ติดตามผล (รหัส = 3)                                  
3. เลือกเงื่อนไข ระหว่าง  ผู้ป่วยใหม่ ผู้ป่วยเก่า โดยบันทึกรหัส 1,2  จะได้ผลลัพธ์เหมือนกัน   

แถบแสงจะรออยู่ที่ "เท่ากับ" กดแป้น <Enter> อาชีพ รับราชการมีรหัส = 201 บันทึก 201 กดแป้น
<Enter> จอภาพจะปรากฏข้อความ ดังนี้
               เงื่อนไข     
                อาชีพ       เท่ากับ 201               
                                              และ            
                 หรือ          
                                              หมดเงื่อนไข        
                                                       
เมื่อเลือกหมดเงื่อนไข แล้วจะจอภาพจะมีข้อความให้บันทึกระยะเวลาที่ต้องการ มีรายละเอียดดังนี้
              
              ตั้งแต่วันที่ __/__/____       ถึงวันที่ __/__/____            
              
จะทำการคำนวณให้และแสดงผลทางจอภาพ 
   รายงานแบบตาราง        
                        รายชื่อผู้ป่วยเรียงตามเลขประจำตัว     หน้าที่ 1      
                               รพท.มหาสารคาม                         
        เลขที่ผู้ป่วยนอก          ชื่อ - นามสกุล              สิทธิการรักษา   
        0000003      นส.สุวรรณา เสมอเนตร                    20      
        รวมจำนวนคนไข้ทั้งหมด 1 คน                                     
        หมายเหตุ                                                    
                  ตั้งแต่วันที่ 13 ส.ค. 2538 ถึงวันที่ 13 ส.ค. 2538                 
                  โดย สภาพสมรสเท่ากับโสด                             
      
     หากต้องการเก็บผลไว้ เมื่อกดปุ่ม F1 จะมีเมนูย่อยอธิบายวิธี
คือ กดปุ่ม [P]  เพื่อพิมพ์รายงานลงกระดาษ 
   กดปุ่ม [C]  เพื่อเก็บรายงานลงแผ่น DISK 
   กดปุ่ม [Esc]เพื่อเลิกรายการนี้
สามารถใช้ได้กับทุกรายงานในการจัดทำรายงานต่างๆจากรายการค้นหาตามเงื่อนไข
     เมื่อกดปุ่ม [P] จะมีเมนูให้เลือกว่าต้องการพิมพ์รายงานด้วยกระดาษชนิดไหน
          
              1. พิมพ์กระดาษที่ละแผ่น   
              2. พิมพ์กระดาษต่อเนื่อง   
          
หากเครื่องพิมพ์ยังไม่พร้อม จะมีข้อความเตือนที่มุมด้านบน "เครื่องพิมพ์ไม่พร้อม โปรดแก้ไข หรือ กดปุ่ม
[Esc] ยกเลิกจากพิมพ์"
     กดปุ่ม [C] จะมีข้อความให้บันทึกชื่อแฟ้มข้อมูล ดังนี้
          
              เก็บข้อมูลไว้ในแฟ้มชื่อ ___________              
          
บันทึกชื่อแฟ้มข้อมูลที่ต้องการเก็บข้อมูลรายงานนั้นไว้ โดยเก็บไว้ใน C:\OPD หากต้องการนำข้อมูลมาใช้
ใช้คำสั่งType ตามด้วยชื่อแฟ้มข้อมูลที่ตั้งไว้                                            
     เลือก 4. ค้นหาคนไข้ใหม่ในปีตามเงื่อนไข เป็นการคำนวณมาตาราง 2 มิติ ของคนไข้ใหม่ในปีตาม
เงื่อนไขที่กำหนด เมื่อเลือกรายการนี้จอภาพจะปรากฏจำนวนปีที่ต้องการหาคนไข้ใหม่ในปี ดังนี้  
               
                   ต้องการหาคนไข้ใหม่ปี            
                 
เมื่อบันทึกปีที่ต้องการหาผู้ป่วยใหม่แล้ว จอภาพจะปรากฏข้อความ ให้บันทึกตัวแปรต่างๆ ที่ต้องการ โดยวิธี
เลือกต่างๆ เหมือนกับรายการค้นหาตามเงื่อนไข ที่ได้กล่าวมาแล้วข้างต้น
  รายงานแบบตาราง    
  หน้าที่ 1                ตารางเปรียบเทียบระหว่าง อาชีพ กับ เพศ                   
                                   รพท.มหาสารคาม                           
                                       ชาย        หญิง      รวม         %   
  รับราชการ (ข้าราชการพลเรือน)              0          1         1      33.33 
  ในความปกครอง                           1          1         2      66.67 
  รวม                                    1          2         3     100.00 
   %                                 33.33      66.67    100.00            
  หมายเหตุ                                                                  
            ข้อมูลผู้ป่วยใหม่ปี 38                                                
    

หมายเหตุ 
          การคำนวณข้อมูลโปรแกรมจะดึงข้อมูลจากแฟ้ม FILEYY และ MEDREC  
.pa
     เลือก 5. ค้นหา HN และชื่อของคนไข้ใหม่ในปีตามเงื่อนไข สำหรับรายการนี้ใช้ค้นหาเลขที่ผู้ป่วยนอก
และชื่อของคนไข้ใหม่ในปี ตามเงื่อนไขที่เรากำหนดเองได้ โดยจอภาพจะปรากฏข้อความในบันทึกปีที่ต้องการ
                                   
                   ต้องการหาคนไข้ใหม่ปี            
               
เมื่อบันทึกปีที่ต้องการหาผู้ป่วยใหม่แล้ว จอภาพจะปรากฏข้อความ ให้บันทึกตัวแปรต่างๆ ที่ต้องการ โดยวิธี
เลือกต่างๆ เหมือนกับรายการค้นหา HN และชื่อตามเงื่อนไข ที่ได้กล่าวมาแล้วข้างต้น
      รายงานแบบตาราง
                           รายชื่อผู้ป่วยเรียงตามเลขประจำตัว     หน้าที่ 1  
                                 รพท.มหาสารคาม                    
        เลขที่ผู้ป่วยนอก   ชื่อ - นามสกุล                    สิทธิการรักษา   
        0000001      ดญ.ฐิติพรรณ มานะเจริญ                    20            
        0000003      นส.สุวรรณา เสมอเนตร                    20           
        รวมจำนวนคนไข้ทั้งหมด 2 คน                                           
        หมายเหตุ   ข้อมูลผู้ป่วยใหม่ปี 38                                        
                  โดย เพศไม่เท่ากับชาย                                      
          


     เลือก 6. หาจำนวนคนไข้รับไว้ในโรงพยาบาล เป็นการหาจำนวนผู้ป่วยที่รับไว้เป็นผู้ป่วยใน โดยมี
การเลือกรายการต่างๆ เหมือนกับการค้นหาตาเงื่อนไข ที่ได้กล่าวมาแล้วข้างต้น
     รายงานแบบตาราง
        หน้าที่ 1              ตารางเปรียบเทียบระหว่าง สภาพสมรส กับ เพศ      
                                 รพท.มหาสารคาม                    
                           ชาย        หญิง      รวม         %          
        โสด                  1          2         3     100.00        
        รวม                  1          2         3     100.00        
         %               33.33      66.67    100.00                   
        หมายเหตุ   ตั้งแต่วันที่ 13 ส.ค. 2538 ถึงวันที่ 13 ส.ค. 2538             
         
หมายเหตุ  หากต้องการข้อมูลผู้ป่วยในทั้งหมด ในช่วงเลือกวัน/เดือน/ปี ให้กดแป้น <Enter> ผ่าน ก็จะได้
         จำนวนผู้ป่วยในทั้งหมดของโรงพยาบาล 

                           การสำรองข้อมูล
     ในส่วนของการสำรองข้อมูล สามารถดำเนินการได้ด้วย การสำรองไว้ในเทป หรือ แผ่นดิสก์อยู่ หาก
แต่การนำข้อมูลมาใช้อาจจะต้องใช้เวลานาน ซึ่งจะทำระบบการปฏิบัติงานต้องหยุดชะงักไป ดังนั้นจึงได้พัฒนา
โปรแกรมสำรองข้อมูลแบบ on line โดยโปรแกรมจะดำเนินการสำรองของในส่วนของห้องบัตรไว้ เพราะ
ถือว่าเป็นส่วนที่สำคัญและหากระบบในส่วนนี้หยุดชะงักจะทำให้นี้มีปัญหาระบบงานอื่นๆ ด้วย ซึ่งจะมีประโยชน์
มากในกรณีที่เกิดปัญหากับแฟ้มดัชนี เราสามารถแก้ไขได้ในเวลาไม่ถึง 5 นาที
     โปรแกรมสำรองข้อมูลใน 2 ลักษณะ คือ
          1. จะสำรองข้อมูลไว้ใน directory เดียวกับ PATIENT1 (เหมือนโปรแกรม AUDIT เดิม)
          2. ถ้าใน Configuration file (เช่น STAT2.CFG) ได้กำหนดคำสั่งว่า
          BACKUPDRIVE  = <ชื่อไดร์ฟ> (อาจเป็น Local disk หรือ File server อีกตัวก็ได้)
     หรือใช้รายการกำนหนดค่าระบบ ในบำรุงรักษาระบบ ใน STAT2 โปรแกรมจะสำรองข้อมูลต่าง ๆ 
ไว้ในไดร์ฟที่กำหนดไว้ โดยจะสำรองข้อมูล PATIENT1, PATIENT2, CONTACT, HNCOUNT, ANCOUNT 
เป็นแบบ REAL TIME และจะสำรองข้อมูลอื่น ๆ ทั้งข้อมูลผู้ป่วยนอกและผู้ป่วยในทุก 1 ชั่วโมง โดยจะสำรอง
เฉพาะแฟ้มที่มีการแก้ไขเปลี่ยนแปลง จะไม่สำรองข้อมูลที่เกิดจากการคำนวณ เช่น รายงานต่าง ๆ ดังนั้น 
ถ้าเราสำรองข้อมูลไว้ที่ Local disk เมื่อ File server เกิดปัญหาขึ้นก็สามารถใช้คอมพิวเตอร์ตัวที่สำรอง
ข้อมูลนี้ทำงานต่อได้ทันที
               วิธีการเรียกการสำรองข้อมูลนั้นเรียกได้จาก 2 จุด คือ
     1. เรียกจากเมนูสำรองข้อมูล ในบำรุงรักษาระบบ ในSTAT2 
     2. เมื่ออยู่ที่หน้าจอบันทึกข้อมูลของงานห้องบัตร ให้กดปุ่ม [Alt]+[B] ซึ่งถ้าเรียกโดยวิธีที่ 2 นี้ 
เราก็ยังคงสามารถพิมพ์บัตรผู้ป่วยใหม่ และพิมพ์ใบสั่งยาได้ตามปกติ โดยกดปุ่ม [Alt]+[N] สำหรับสั่งพิมพ์
บัตรคนไข้ใหม่ และกดปุ่ม [Alt]+[R] สำหรับสั่งพิมพ์ใบสั่งยา
     หลักการในการทำงานของโปรแกรม audit ก็คือจะคอยตรวจสอบว่ามีการเปลี่ยนแปลงข้อมูลในแฟ้มที่
เกี่ยวกับข้อมูลพื้นฐานของผู้ป่วยแล้วทำการสำรองไว้ที่แฟ้มอื่น ดังนี้
          PATIENT1.DBF   ->    PAT1.DBF
          PATIENT1.CDX   ->    PAT1.CDX
          PATIENT2.DBF   ->    PAT2.DBF
          PATIENT2.CDX   ->    PAT2.CDX
          CONTACT.DBF    ->    CONTACT.DBF
          CONTACT.CDX    ->    CONTACT.CDX




     เมื่อเกิดปัญหาว่าแฟ้มข้อมูลเสีย ( patient1, patient2, contact ) ไม่สามารถทำงาน
ในห้องบัตรได้ ต้องแก้ไขดังนี้
          1. ในกรณีที่เป็นระบบแลน ให้เครื่องอื่น ๆ ที่ทำงานด้วยโปรแกรม STAT2, OPD, 
ADM_CEN, และ IPD หยุดงานและออกจากโปรแกรมก่อน
          2. เปลี่ยนชื่อแฟ้มข้อมูลและลบแฟ้มดัชนี โดยใช้คำสั่งดังต่อไปนี้ในดอส
               REN PATIENT1.DBF PATI1.DBF 
               REN PATIENT1.CDX PATI1.CDX
               REN PATIENT2.DBF PATI2.DBF 
               REN PATIENT2.CDX PATI2.CDX
               REN CONTACT.DBF CONTS.DBF
               REN CONTACT.CDX CONTS.CDX
               REN PAT1.DBF PATIENT1.DBF 
               REN PAT1.CDX PATIENT1.CDX
               REN PAT2.DBF PATIENT2.DBF 
               REN PAT2.CDX PATIENT2.CDX
               REN CONT.DBF CONTACT.DBF
               REN CONT.CDX CONTACT.CDX
               REN PATI1.DBF PAT1.DBF 
               REN PATI1.CDX PAT1.CDX
               REN PATI2.DBF PAT2.DBF 
               REN PATI2.CDX PAT2.CDX
               REN CONTS.DBF CONT.DBF
               REN CONTS.CDX CONT.CDX
               DEL PAT1.CDX
               DEL PAT2.CDX
               DEL CONT.CDX
     หรืออาจจะพิมพ์คำสั่งทั้งหมดไว้ใน batch file เพื่อความสะดวกก็ได้ (สามารถทุ่นเวลาได้โดยขณะ
ที่ท่านใช้โปรแกรม cw หรือ rw อ่านแฟ้มนี้อยู่ ให้ทำ block คำสั่งทั้งหมด แล้วใช้คำสั่งเขียน block ไป
เป็นแฟ้มชื่ออะไรก็ได้ที่มีนามสกุล .bat แล้วให้เรียกชื่อแฟ้มนั้น)
          3. ให้เข้าโปรแกรม Foxpro แล้วทำการสร้างแฟ้มดัชนีใหม่ดังนี้
           USE PAT1 EXCL
           INDEX ON hn TAG hn
           INDEX ON name TAG name ADDI
           INDEX ON SUBS(name,AT(' ',name)+1,4) TAG last ADDI
           INDEX ON LEFT(name,4)+SUBS(name,AT(' ',name)+1,4) TAG namelast ADDI
           INDEX ON clinic TAG clinic ADDI
           INDEX ON lastdate TAG lastdate ADDI
           USE PAT2 EXCL
           INDEX ON hn TAG hn            
           USE CONT EXCL
           INDEX ON hn TAG hn            
           CLOSE DATA
     หรืออาจจะพิมพ์คำสั่งทั้งหมดไว้ใน .prg file เพื่อความสะดวกก็ได้ (สามารถทุ่นเวลาได้โดยขณะ
ที่ท่านใช้โปรแกรม cw หรือ rw อ่านแฟ้มนี้อยู่ ให้ทำ block คำสั่งทั้งหมด แล้วใช้คำสั่งเขียน block ไป
เป็นแฟ้มชื่ออะไรก็ได้ที่มีนามสกุล .prg แล้วใน Foxpro ให้ใช้คำสั่ง DO <filename> )ด้วยวิธีนี้จะใช้เวลา
สำหรับการแก้ไขระบบงานในห้องบัตรน้อย จะสามารถดำเนินงานต่อไปได้
     ในกรณีที่เป็นระบบ Standalone เวลาสำหรับการทำโปรแกรม ควรเป็นช่วงต่อเวรทุกเวร 
เพื่อที่จะได้สูญเสียน้อยที่สุดเมื่อมีปัญหาเกิดขึ้น และควรตรวจสอบเนี้อที่ของ Harddisk ว่ามีเพียงพอสำหรับ
การสำรองข้อมูลหรือไม่
     ในกรณีที่เป็นระบบเครือข่าย ควรมี workstation หนึ่งเพื่อทำงานนี้โดยเฉพาะ ให้ใช้ spec 
ของเครื่องเหมือน workstation อื่น แต่ควรมีขนาด hard disk ไม่น้อยกว่า 300 - 500 MB ซึ่งตัวนี้
จะมีประโยชน์ต่อไปในภายภาคหน้าคือ ขณะนี้กำลังจะพัฒนาโปรแกรมให้สามารถสำรองมาที่ไดร์ฟ C ได้ด้วย 
ซึ่งจะทำให้สามารถแก้ไขปัญหา File server เสีย ก็จะสามารถทำงานต่อบนเครื่องนี้ได้เลย
.pa
               การออกจากโปรแกรมและเลิกงาน
 
    ถ้าเราต้องการที่จะเลิกงาน ไม่ว่าจะอยู่ที่จอภาพใดก็ตามให้กดแป้น <Esc> ไปจนกว่าจะถึงจอภาพ
รายการหลัก เมื่อถึงจอภาพรายการหลักแล้วให้กดแป้น <Esc> อีก 1 ครั้ง หรือเลือนแถบแสงไปที่เลิกงาน 
แล้วกด <<Enter>> จะกลับคืนสู่ F:\>PUB>  ถ้าต้องการที่จะเลิกงานก็ให้ พิมพ์ LOGOUT แล้วกดแป้น 
<Enter> จอภาพจะแสดง F:\LOGIN> เมื่อถึงตรงนี้แล้วก็สามารถปิดเครื่องได้

     HOT KEYS
     จอภาพลงทะเบียนผู้ป่วยและจอภาพแก้ไขข้อมูลผู้ป่วยริมขวาสุดจะมีตัวเลข 1 ถึง 8 สามารถไปยัง
บรรทัดต่างๆ ได้ โดยกดแป้น  Alt  แล้วตามด้วยตัวเลข  ของบรรทัดที่ต้องการ เช่น ต้องการไปแก้ไข
ชื่อผู้ติดต่อได้ ให้กดแป้น Alt ค้างแล้วกดแป้นตัวเลข 6 cursor จะมาอยู่ตรงบรรทัดชื่อผู้ติตต่อได้

     ผู้พัฒนาระบบ  คณะทำงานพัฒนาโปรแกรมบริการผู้ป่วยนอก ผู้ป่วยในและงานเวชระเบียน เพื่อให้
ผู้ใช้ติดต่อขอปรึกษาเมื่อมีปัญหาและข้อเสนอแนะเกี่ยวกับโปรแกรมฯ                              
นายแพทย์ประดิษฐ์   วงษ์คณารัตนกูล  E-mail pradit@health.moph.go.th         
นายแพทย์วิรัตน์     ลือวิเศษไพบูลย์  E-mail virat@health.moph.go.th    
นายแพทย์ยุทธพงศ์   พตด้วง        E-mail yuthpong@health.moph.go.th    
นายแพทย์ถาวร     สกุลพาณิชย์     Email thaworn@health.moph.go.th
นางสาวสุวรรณา    เสมอเนตร     E-mail suwanna@health.moph.go.th  
                             โทรสาร (02)591-8630
.paRW2+!ย     M ฝญฬด eฦeฦ    @ @ @                  